# Customization Guide

## 1) Integration data (real HACS data)

Files generated by sync:
- `src/data/hacs/integration-data.json`
- `src/data/hacs/integration-repositories.json`
- `src/data/hacs/last-sync.json`

Update datasets with:

```bash
npm run sync:hacs
```

Note: `npm run build` already runs sync automatically.

## 2) Page layout and content

File: `src/pages/index.astro`

- Hero: headline, copy, CTA, stats
- Sections: featured + catalog
- Top navigation: blog access + theme toggle
- Catalog controls: search/filter/sort + confidence
- Score explainability block
- Compare drawer + modal
- Minimal script: initialize catalog by importing `initCatalog`
- Category mapping: `toCategory()` function

Blog pages:
- `src/pages/blog/index.astro`
- `src/pages/blog/[...page].astro`
- `src/pages/blog/post/[slug].astro`
- `src/pages/blog/category/[slug].astro`
- `src/pages/blog/tag/[slug].astro`
- `src/pages/rss.xml.ts`

File: `src/scripts/catalog.ts`
- UI init: `initCatalog()` (DOM wiring, render, load more, reset, presets, compare)
- URL state: sync filters with query params
- Non-blocking rendering with Web Worker + skeleton cards

File: `src/scripts/catalog-core.ts`
- Pure functions: `filterRows`, `sortRows`, `stateToQuery`, `queryToState`, `applyPreset`
- Default sort: `recommended-desc`
- Includes confidence filter state and `reliable` preset

File: `src/scripts/catalog.worker.ts`
- Off-main-thread filter/sort for smoother UX on large datasets

File: `src/lib/score-model.ts`
- Shared score constants and formulas used by data loader + UI
- Percentiles, freshness grace+decay, maintenance signal, final score/confidence

## 3) Integration cards

File: `src/components/IntegrationCard.astro`

- Featured card visual structure
- Key metrics: repo, stars, updated date, domain, confidence
- Inline score help tooltip

## 4) Global SEO

File: `src/layouts/BaseLayout.astro`

- Dynamic title/description
- Open Graph / Twitter
- Canonical

File: `src/pages/index.astro`
- JSON-LD

File: `src/pages/robots.txt.ts`
- Dynamic crawling rules + sitemap URL generation per deployment domain/base path

Sitemap generation:
- `@astrojs/sitemap` integration in `astro.config.mjs`
- Post-build alias script `scripts/alias-sitemap.mjs` to keep `sitemap.xml` compatibility

File: `src/lib/seo.ts`
- Shared SEO builders for home, integration, blog index, and blog post routes

## 5) Design system

File: `src/styles/global.css`

Main points:
- `daisyui` plugin enabled on Tailwind
- daisyUI themes `hacs-dark` and `hacs-light` with shared tokens
- Base typography + gradient background in `@layer base`
- daisyUI components (`btn`, `card`, `input/select`, `badge`, `checkbox`)
- Tailwind utility classes used directly in Astro templates
- Local fonts via `@fontsource-variable/space-grotesk` and `@fontsource/syne`

## 6) Mobile UX

Already included:
- Responsive section and card layouts
- Quick presets and filter reset

Possible extensions:
- Icon-based quick filters
- Sticky action bar for `Reset/Load more`
- Persist filters in query string

## 7) Accessibility

Already included:
- Skip link
- Focus ring
- `aria-live` for results
- Reduced motion support

Possible extensions:
- Full WCAG audit
- Screen reader testing
- Automatic contrast checks in CI

## 8) Tests

Files:
- `src/scripts/catalog.test.ts`
- `src/lib/score-model.test.ts`

Coverage:
- Catalog pure functions and URL state behavior
- Shared score model helpers and formula boundaries
- Run with `npm run test`
- Lighthouse quality gate via `npm run test:lighthouse` (`.lighthouserc.json`)

## 9) Detail pages

File: `src/pages/integration/[slug].astro`
- Static generation of one page per integration
- Uses real HACS data via `src/data/hacs/load.ts`
- Breakdown values computed with shared score model helpers

## 10) Analytics and instrumentation

Files:
- `src/scripts/analytics.ts`
- `src/layouts/BaseLayout.astro`

Behavior:
- Defines `window.__hacsTrack` as a safe noop when Umami is disabled
- Loads Umami only in production when `WEBSITE_ID` is set
- Tracks explicit `data-umami-event` interactions and outbound clicks
